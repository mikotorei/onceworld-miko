{{ define "main" }}

<h1>{{ .Title }}</h1>

<!-- monsters-data.js を読み込む（生成済み） -->
<script src="{{ "monsters-data.js" | relURL }}"></script>

<section>
  <h2>主人公ステータス</h2>

  <div class="hero-grid">

    <div class="hero-row">
      <span class="hero-label">atk:</span>
      <input id="hero-atk" type="number" inputmode="numeric" min="0" step="1" value="0">
    </div>

    <div class="hero-row">
      <span class="hero-label">int:</span>
      <input id="hero-int" type="number" inputmode="numeric" min="0" step="1" value="0">
    </div>

    <div class="hero-row">
      <span class="hero-label">spd:</span>
      <input id="hero-spd" type="number" inputmode="numeric" min="0" step="1" value="0">
    </div>

    <div class="hero-row">
      <span class="hero-label">luk:</span>
      <input id="hero-luk" type="number" inputmode="numeric" min="0" step="1" value="0">
    </div>

    <div class="hero-row">
      <span class="hero-label">def:</span>
      <input id="hero-def" type="number" inputmode="numeric" min="0" step="1" value="0">
    </div>

    <div class="hero-row">
      <span class="hero-label">mdef:</span>
      <input id="hero-mdef" type="number" inputmode="numeric" min="0" step="1" value="0">
    </div>

  </div>
</section>

<div id="calc-app"></div>

<style>
  .hero-grid{
    display:grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 12px;
    max-width: 720px;
  }

  .hero-row{
    display:flex;
    align-items:center;
    gap: 8px;
  }

  .hero-label{
    font-weight: 600;
    white-space: nowrap;
  }

  .hero-row input{
    flex: 1;
    min-width: 0;
    padding: 8px 10px;
    border: none;
    outline: none;
    background: transparent;
    font-size: 16px;
    border-bottom: 1px solid #000;
    border-radius: 0;
  }
</style>

<script>
  // 整数・0以上・空欄は0に戻す
  (function () {
    const ids = ["hero-atk","hero-int","hero-spd","hero-luk","hero-def","hero-mdef"];

    function normalize(el){
      const raw = (el.value ?? "").toString().trim();
      if (raw === "") { el.value = "0"; return; }
      const n = Math.floor(Number(raw));
      if (!Number.isFinite(n) || n < 0) { el.value = "0"; return; }
      el.value = String(n);
    }

    ids.forEach(id => {
      const el = document.getElementById(id);
      if (!el) return;
      normalize(el);
      el.addEventListener("blur", () => normalize(el));
    });
  })();
</script>

{{ end }}
