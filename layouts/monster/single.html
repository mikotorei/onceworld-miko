{{ define "main" }}
<h1 class="d-title">{{ .Title }}</h1>

<p style="margin:8px 0; font-size:12px; opacity:.7;">
  DEBUG pet_skills type={{ printf "%T" .Params.pet_skills }} /
  len={{ cond (isset .Params "pet_skills") (len .Params.pet_skills) 0 }}
</p>

{{ with .Params.image }}
  {{ $img := strings.TrimPrefix "/" . }}
  <div class="d-hero">
    <img class="d-hero-img" src="{{ $img | relURL }}" alt="{{ $.Title }}">
  </div>
{{ end }}

<p class="d-line">
  名前：{{ .Title }}（{{ .Params.attack_type }}・{{ .Params.attack_range }}・{{ .Params.element }}）
</p>

{{ with .Params.pet_skills }}
<section class="d-block">
  <h2 class="d-h2">ペットスキル</h2>

  {{ $levels := slice 31 71 121 181 }}

  <dl class="d-list">
    {{ range $i, $ps := . }}
      <div class="d-row">
        <dt>Lv{{ index $levels $i }}</dt>
        <dd>
          {{ $out := slice }}

          {{ with index $ps "add" }}
            {{ range $k, $v := . }}
              {{ $out = $out | append (printf "%s+%v" $k $v) }}
            {{ end }}
          {{ end }}

          {{ with index $ps "mul" }}
            {{ range $k, $v := . }}
              {{ $out = $out | append (printf "%s×%v%%" $k (mul $v 100)) }}
            {{ end }}
          {{ end }}

          {{ with index $ps "final_mul" }}
            {{ range $k, $v := . }}
              {{ $out = $out | append (printf "%s×%v%%(最終)" $k (mul $v 100)) }}
            {{ end }}
          {{ end }}

          {{ delimit $out " / " }}
        </dd>
      </div>
    {{ end }}
  </dl>
</section>
{{ end }}

<p class="d-back">
  <a href="{{ .CurrentSection.RelPermalink }}">← モンスター一覧に戻る</a>
</p>
{{ end }}
